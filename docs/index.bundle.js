"use strict";(self.webpackChunklearning_threejs_baz=self.webpackChunklearning_threejs_baz||[]).push([[826],{178:(e,t,n)=>{var a=n(477),i=n(79),s=n(11),o=n(452),r=n(259),d=n(365);class h{constructor(){this.initComponents(),this.bindEvents()}initComponents(){this.el=document.querySelector("[data-loading-screen]")}bindEvents(){this.el.addEventListener("transitionend",this.destroy.bind(this))}hide(){this.el.classList.add("fade-out")}destroy(){this.el.remove()}}class c{constructor(e,t,n){this.scene=e,this.textureLoader=t,this.gizmo=n,this.environmentMap(),this.keyLight()}environmentMap(){this.textureLoader.load("environments/goegap_4k.exr",(e=>{e.mapping=a.dSO,e.encoding=a.knz,this.scene.environment=e,this.scene.background=e}))}keyLight(){const e=new a.Ox3;e.name="keyLight",e.color=new a.Ilk("rgb(255, 245, 200)"),e.intensity=9,e.position.set(-500,250,-1e3),e.target.position.set(0,0,0),e.castShadow=!0,e.shadow.camera.left=-400,e.shadow.camera.right=400,e.shadow.camera.bottom=-400,e.shadow.camera.top=400,e.shadow.camera.near=800,e.shadow.camera.far=2e3,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,this.scene.add(e),this.scene.add(e.target);const t=new a.cBI(e);t.name="keyLight-helper",this.scene.add(t);const n=new a.Rki(e.shadow.camera);this.scene.add(n)}update(){this.spotLightHelper&&this.spotLightHelper.update(),this.shadowHelper&&this.shadowHelper.update()}}class l{constructor(e,t){this.geoLoader=e,this.textureLoader=t,this.materials={},this.rootObject=null,this.initMaterials(),this.initGeo()}initMaterials(){this.materials.default=new a.Wid({normalMap:this.textureLoader.load("models/ground1/textures/vmoebgzqx_4K_Normal_LOD0.jpg"),roughnessMap:this.textureLoader.load("models/ground1/textures/vmoebgzqx_4K_Roughness.jpg"),map:this.textureLoader.load("models/ground1/textures/vmoebgzqx_4K_Albedo.jpg"),envMapIntensity:.1}),this.materials.default.map.encoding=a.knz}initGeo(){this.rootObject=new a.ZAu,this.rootObject.name="ground1",this.geoLoader.load("models/ground1/vmoebgzqx_LOD0.fbx",(e=>{const t=e.children[0];t.geometry.attributes.uv2=t.geometry.attributes.uv,t.castShadow=!0,t.receiveShadow=!0,t.material=this.materials.default,this.rootObject.add(t)}))}update(){}}var g=n(376);const u=function(e){var t=new i.Z;return t.showPanel(0),document.body.appendChild(t.dom),t}(),p=function(e){const t=new a.CP7({powerPreference:"high-performance",alpha:!0});return t.setSize(window.innerWidth,window.innerHeight),t.shadowMap.enabled=!0,t.shadowMapSoft=!0,t.shadowMap.type=a.ntZ,t.physicallyCorrectLights=!0,t.outputEncoding=a.knz,document.getElementById("webgl-output").appendChild(t.domElement),t}(),m=function(e){var t=void 0!==e?e:new a.Pa4(0,22,50),n=new a.cPb(45,window.innerWidth/window.innerHeight,1,2e3);return n.position.copy(t),n.lookAt(new a.Pa4(0,0,0)),n}(new a.Pa4(0,80,150)),w=new class{constructor(e,t){this.renderer=e,this.camera=t,this.scene=new a.xsS,this.loadingManager=new a.lLk,this.materials={},this.pickableMeshes=[],this.objLoader=new s.L(this.loadingManager),this.objLoader.setPath("assets/"),this.fbxLoader=new o.y(this.loadingManager),this.fbxLoader.setPath("assets/"),this.textureLoader=new a.dpR(this.loadingManager),this.textureLoader.setPath("assets/"),this.exrLoader=new r.I(this.loadingManager),this.exrLoader.setPath("assets/"),this.orbitControls=this.initControls(),this.addObjects(),this.lights=new c(this.scene,this.exrLoader),this.initComponents(),this.bindEvents()}initControls(){const e=new d.z(this.camera,this.renderer.domElement);return e.target=new a.Pa4(0,20,0),e.enablePan=!1,e.minPolarAngle=a.M8C.degToRad(30),e.maxPolarAngle=a.M8C.degToRad(80),e.autoRotate=!1,e.enableDamping=!0,e}addObjects(){const e=new a.VLJ(500,10);e.material.transparent=!0,e.material.opacity=.25,this.scene.add(e);const t=new a.y8_(10);this.scene.add(t),this.ground1=new l(this.fbxLoader,this.textureLoader),this.scene.add(this.ground1.rootObject)}initComponents(){this.loadingScreen=new h}bindEvents(){this.loadingManager.onLoad=this.onLoad.bind(this)}onLoad(){this.loadingScreen.hide()}update(){this.orbitControls.update()}fitCameraToSelection(e,t,n,i=1.1){const s=new a.ZzF;for(const e of n)s.expandByObject(e);const o=s.getSize(new a.Pa4),r=s.getCenter(new a.Pa4),d=Math.max(o.x,o.y,o.z)/(2*Math.atan(Math.PI*e.fov/360)),h=d/e.aspect,c=i*Math.max(d,h),l=t.target.clone().sub(e.position).normalize().multiplyScalar(c);t.minDistance=c/2,t.maxDistance=3*c,t.target.copy(r),t.target.y=-4,e.near=c/100,e.far=100*c,e.updateProjectionMatrix(),e.position.copy(t.target).sub(l),t.update()}}(p,m);new class{constructor(e,t,n,a){this.camera=e,this.scene=t.scene,this.materials=t.materials,this.gui=new g.XS,this.heightScale=.2,this.bouncingSpeed=.04,this.showRay=!1;const i=this.scene.getObjectByName("keyLight"),s=this.scene.getObjectByName("keyLight-helper");if(i){const e=this.gui.addFolder("Key light");e.add(i.position,"x",-1e3,1e3).onChange((()=>{this.updateLight(i,s)})),e.add(i.position,"y",100,1e3).onChange((()=>{this.updateLight(i,s)})),e.open()}}updateLight(e,t){e.target.updateMatrixWorld(),t.update()}outputObjects(){console.log(this.scene)}}(m,w),window.addEventListener("resize",(function(){m.aspect=window.innerWidth/window.innerHeight,m.updateProjectionMatrix(),p.setSize(window.innerWidth,window.innerHeight)}),!1),function e(){u.update(),w.update(),p.render(w.scene,m),window.requestAnimationFrame(e)}()}},e=>{e.O(0,[813,474],(()=>(178,e(e.s=178)))),e.O()}]);